{"ast":null,"code":"var _jsxFileName = \"/Users/lihanzhu/Desktop/hw2 2/hw2/client/src/components/login.js\";\nimport Button from \"@material-ui/core/Button\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: \"\",\n      password: \"\" // loginAttempt: 0,\n      // lockoutTime: undefined,\n      // lockoutArray: new Map(),\n\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleInputChange = this.handleInputChange.bind(this);\n  }\n  /* istanbul ignore next */\n  // timer() {\n  //   setTimeout(() => {\n  //     window.top.location = \"https://project557.herokuapp.com/homepage\";\n  //   }, 2000);\n  // }\n\n  /* istanbul ignore next */\n\n\n  handleSubmit(e) {\n    e.preventDefault(); // ]\n\n    if (this.state.username.length !== 0 && this.state.password.length !== 0) {\n      if (document.getElementById(\"loginErrorMessage\") !== null) {\n        document.getElementById(\"loginErrorMessage\").setAttribute(\"style\", \"display: none;\");\n      } /// lockout/////////////////////////////////////////////////////////\n\n\n      if (localStorage.getItem(this.state.username) !== null) {\n        const arrayTemp = localStorage.getItem(this.state.username).split(\" \");\n        const loginAttempt = parseInt(arrayTemp[0]);\n        const lockoutTime = arrayTemp[1];\n        console.log(`loginAttempt = ${loginAttempt}`);\n        console.log(`lockoutTime = ${lockoutTime}`);\n\n        if (loginAttempt >= 3 && lockoutTime !== \"undefined\" && (Date.now() - parseInt(lockoutTime)) / 1000 < 30) {\n          console.log(\"lockout in effect!\"); // document.getElementById(\"loginButton\").innerHTML = \"Lockout 30sec\";\n\n          return;\n        }\n      }\n\n      document.getElementById(\"loginButton\").innerHTML = \"Login\"; /// lockout/////////////////////////////////////////////////////////\n\n      const requestOptions = {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify({\n          username: this.state.username,\n          password: this.state.password\n        })\n      };\n      console.log(requestOptions);\n      fetch(\"http://localhost:8080/login\", requestOptions).then(res => {\n        console.log(res.status);\n\n        if (res.status === 200) {\n          const loginMessage = document.createElement(\"p\");\n          loginMessage.innerHTML = \"Welcome back buddy!\";\n          loginMessage.setAttribute(\"id\", \"loginMessage\");\n          loginMessage.setAttribute(\"style\", \"color: green;\");\n          const login = document.getElementById(\"login\");\n          login.appendChild(loginMessage); /// lockout/////////////////////////////////////////////////////////\n\n          localStorage.setItem(this.state.username, `${0} undefined`); /// lockout/////////////////////////////////////////////////////////\n\n          setTimeout(() => {\n            window.top.location = \"http://localhost:3000/homepage\";\n          }, 2000);\n          this.props.saveUserNameAndPassWord(this.state.username, this.state.password); // document.getElementById(\"loginMessage\").remove();\n        } else {\n          let loginErrorMessage = null;\n\n          if (document.getElementById(\"loginErrorMessage\") === null) {\n            loginErrorMessage = document.createElement(\"p\");\n            loginErrorMessage.innerHTML = \"Your username or password is incorrect\";\n            loginErrorMessage.setAttribute(\"id\", \"loginErrorMessage\");\n            loginErrorMessage.setAttribute(\"style\", \"color: red;\");\n            const login = document.getElementById(\"login\");\n            login.appendChild(loginErrorMessage);\n          } else {\n            document.getElementById(\"loginErrorMessage\").setAttribute(\"style\", \"display: inline; color: red \");\n          } /// lockout//////////////////////////////////////////////////////////////////\n\n\n          let loginAttemptTemp = 1;\n\n          if (localStorage.getItem(this.state.username) === null) {\n            localStorage.setItem(this.state.username, `${1} undefined`);\n            console.log(`${this.state.username} not in map`);\n          } else {\n            loginAttemptTemp = parseInt(localStorage.getItem(this.state.username).split(\" \")[0]) + 1;\n            console.log(`A loginAttemptTemp = ${loginAttemptTemp}`);\n\n            if (loginAttemptTemp >= 3) {\n              const timeTemp = Date.now(); // localStorage.setItem(this.state.username, [loginAttemptTemp, timeTemp]);\n\n              localStorage.setItem(this.state.username, `${loginAttemptTemp} ${timeTemp}`);\n              document.getElementById(\"loginButton\").innerHTML = \"Lockout 30sec\";\n            } else {\n              localStorage.setItem(this.state.username, `${loginAttemptTemp} undefined`);\n            }\n          } /// lockout//////////////////////////////////////////////////////////////////\n\n        }\n      }).catch(() => {\n        console.log(\"Unable to connect to server\");\n      });\n    }\n  }\n\n  handleInputChange(e) {\n    e.preventDefault(); // console.log(e.target.value);\n\n    this.setState({\n      [e.target.name]: e.target.value\n    });\n  }\n\n  render() {\n    const {\n      username,\n      password\n    } = this.state;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"header\", {\n      id: \"App-header\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 158,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      className: \"AppTitle\",\n      id: \"logox\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 11\n      }\n    }, \" \", \"Video & Messaging Web App\")), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"RegisterDiv\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 164,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"loginMain\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 165,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"login\",\n      id: \"login\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 166,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 167,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"fname\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 168,\n        columnNumber: 15\n      }\n    }, \"Username :\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"text\",\n      id: \"LoginUsername\",\n      className: \"loginEle\",\n      name: \"username\",\n      value: username,\n      onChange: this.handleInputChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 169,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"label\", {\n      htmlFor: \"fname\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 179,\n        columnNumber: 15\n      }\n    }, \"Password :\"), /*#__PURE__*/React.createElement(\"input\", {\n      type: \"password\",\n      id: \"loginPassword\",\n      className: \"loginEle\",\n      name: \"password\",\n      value: password,\n      onChange: this.handleInputChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 181,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(Button, {\n      onClick: this.handleSubmit,\n      type: \"button\",\n      id: \"loginButton\",\n      className: \"loginEle\",\n      color: \"primary\",\n      size: \"large\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 13\n      }\n    }, \"Login In\")), /*#__PURE__*/React.createElement(\"div\", {\n      id: \"JumpLink\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 13\n      }\n    }, \" Or you could \"), /*#__PURE__*/React.createElement(Link, {\n      to: \"/register\",\n      id: \"loginLink\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 13\n      }\n    }, \" \", \"register now!\"))));\n  }\n\n}\n\nLogin.propTypes = {\n  saveUserNameAndPassWord: PropTypes.func.isRequired\n};\nexport default Login;","map":{"version":3,"sources":["/Users/lihanzhu/Desktop/hw2 2/hw2/client/src/components/login.js"],"names":["Button","React","Component","Link","PropTypes","Login","constructor","props","state","username","password","handleSubmit","bind","handleInputChange","e","preventDefault","length","document","getElementById","setAttribute","localStorage","getItem","arrayTemp","split","loginAttempt","parseInt","lockoutTime","console","log","Date","now","innerHTML","requestOptions","method","headers","body","JSON","stringify","fetch","then","res","status","loginMessage","createElement","login","appendChild","setItem","setTimeout","window","top","location","saveUserNameAndPassWord","loginErrorMessage","loginAttemptTemp","timeTemp","catch","setState","target","name","value","render","propTypes","func","isRequired"],"mappings":"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","sourcesContent":["import Button from \"@material-ui/core/Button\";\nimport React, { Component } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      username: \"\",\n      password: \"\",\n      // loginAttempt: 0,\n      // lockoutTime: undefined,\n      // lockoutArray: new Map(),\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.handleInputChange = this.handleInputChange.bind(this);\n  }\n\n  /* istanbul ignore next */\n  // timer() {\n  //   setTimeout(() => {\n  //     window.top.location = \"https://project557.herokuapp.com/homepage\";\n  //   }, 2000);\n  // }\n  /* istanbul ignore next */\n  handleSubmit(e) {\n    e.preventDefault();\n    // ]\n    if (this.state.username.length !== 0 && this.state.password.length !== 0) {\n      if (document.getElementById(\"loginErrorMessage\") !== null) {\n        document\n          .getElementById(\"loginErrorMessage\")\n          .setAttribute(\"style\", \"display: none;\");\n      }\n\n      /// lockout/////////////////////////////////////////////////////////\n      if (localStorage.getItem(this.state.username) !== null) {\n        const arrayTemp = localStorage.getItem(this.state.username).split(\" \");\n        const loginAttempt = parseInt(arrayTemp[0]);\n        const lockoutTime = arrayTemp[1];\n\n        console.log(`loginAttempt = ${loginAttempt}`);\n        console.log(`lockoutTime = ${lockoutTime}`);\n        if (\n          loginAttempt >= 3 &&\n          lockoutTime !== \"undefined\" &&\n          (Date.now() - parseInt(lockoutTime)) / 1000 < 30\n        ) {\n          console.log(\"lockout in effect!\");\n          // document.getElementById(\"loginButton\").innerHTML = \"Lockout 30sec\";\n          return;\n        }\n      }\n      document.getElementById(\"loginButton\").innerHTML = \"Login\";\n\n      /// lockout/////////////////////////////////////////////////////////\n\n      const requestOptions = {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          username: this.state.username,\n          password: this.state.password,\n        }),\n      };\n      console.log(requestOptions);\n      fetch(\"http://localhost:8080/login\", requestOptions)\n        .then((res) => {\n          console.log(res.status);\n          if (res.status === 200) {\n            const loginMessage = document.createElement(\"p\");\n            loginMessage.innerHTML = \"Welcome back buddy!\";\n            loginMessage.setAttribute(\"id\", \"loginMessage\");\n            loginMessage.setAttribute(\"style\", \"color: green;\");\n            const login = document.getElementById(\"login\");\n            login.appendChild(loginMessage);\n\n            /// lockout/////////////////////////////////////////////////////////\n            localStorage.setItem(this.state.username, `${0} undefined`);\n            /// lockout/////////////////////////////////////////////////////////\n\n            setTimeout(() => {\n              window.top.location = \"http://localhost:3000/homepage\";\n            }, 2000);\n\n            this.props.saveUserNameAndPassWord(\n              this.state.username,\n              this.state.password\n            );\n            // document.getElementById(\"loginMessage\").remove();\n          } else {\n            let loginErrorMessage = null;\n            if (document.getElementById(\"loginErrorMessage\") === null) {\n              loginErrorMessage = document.createElement(\"p\");\n              loginErrorMessage.innerHTML =\n                \"Your username or password is incorrect\";\n              loginErrorMessage.setAttribute(\"id\", \"loginErrorMessage\");\n              loginErrorMessage.setAttribute(\"style\", \"color: red;\");\n              const login = document.getElementById(\"login\");\n              login.appendChild(loginErrorMessage);\n            } else {\n              document\n                .getElementById(\"loginErrorMessage\")\n                .setAttribute(\"style\", \"display: inline; color: red \");\n            }\n\n            /// lockout//////////////////////////////////////////////////////////////////\n            let loginAttemptTemp = 1;\n\n            if (localStorage.getItem(this.state.username) === null) {\n              localStorage.setItem(this.state.username, `${1} undefined`);\n              console.log(`${this.state.username} not in map`);\n            } else {\n              loginAttemptTemp =\n                parseInt(\n                  localStorage.getItem(this.state.username).split(\" \")[0]\n                ) + 1;\n\n              console.log(`A loginAttemptTemp = ${loginAttemptTemp}`);\n\n              if (loginAttemptTemp >= 3) {\n                const timeTemp = Date.now();\n                // localStorage.setItem(this.state.username, [loginAttemptTemp, timeTemp]);\n                localStorage.setItem(\n                  this.state.username,\n                  `${loginAttemptTemp} ${timeTemp}`\n                );\n\n                document.getElementById(\"loginButton\").innerHTML =\n                  \"Lockout 30sec\";\n              } else {\n                localStorage.setItem(\n                  this.state.username,\n                  `${loginAttemptTemp} undefined`\n                );\n              }\n            }\n            /// lockout//////////////////////////////////////////////////////////////////\n          }\n        })\n        .catch(() => {\n          console.log(\"Unable to connect to server\");\n        });\n    }\n  }\n\n  handleInputChange(e) {\n    e.preventDefault();\n    // console.log(e.target.value);\n    this.setState({ [e.target.name]: e.target.value });\n  }\n\n  render() {\n    const { username, password } = this.state;\n    return (\n      <div>\n        <header id=\"App-header\">\n          <span className=\"AppTitle\" id=\"logox\">\n            {\" \"}\n            Video & Messaging Web App\n          </span>\n        </header>\n        <div id=\"RegisterDiv\" />\n        <div className=\"loginMain\">\n          <div className=\"login\" id=\"login\">\n            <div>\n              <label htmlFor=\"fname\">Username :</label>\n              <input\n                type=\"text\"\n                id=\"LoginUsername\"\n                className=\"loginEle\"\n                name=\"username\"\n                value={username}\n                onChange={this.handleInputChange}\n              />\n            </div>\n            <div>\n              <label htmlFor=\"fname\">Password :</label>\n\n              <input\n                type=\"password\"\n                id=\"loginPassword\"\n                className=\"loginEle\"\n                name=\"password\"\n                value={password}\n                onChange={this.handleInputChange}\n              />\n            </div>\n\n            <Button\n              onClick={this.handleSubmit}\n              type=\"button\"\n              id=\"loginButton\"\n              className=\"loginEle\"\n              color=\"primary\"\n              size=\"large\"\n            >\n              Login In\n            </Button>\n          </div>\n          <div id=\"JumpLink\">\n            <span> Or you could </span>\n            <Link to=\"/register\" id=\"loginLink\">\n              {\" \"}\n              register now!\n            </Link>\n          </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nLogin.propTypes = {\n  saveUserNameAndPassWord: PropTypes.func.isRequired,\n};\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}